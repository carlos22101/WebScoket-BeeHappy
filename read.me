# ğŸ“¡ WebSocket-LifeGuard

Este servidor estÃ¡ escrito en **Go** y permite una comunicaciÃ³n en tiempo real entre una API (emisor) y uno o mÃ¡s clientes Frontend (receptores) utilizando WebSockets. Cada cliente se identifica por su direcciÃ³n MAC, permitiendo mÃºltiples conexiones simultÃ¡neas por la misma cuenta (MAC address).

---

## ğŸ§± Estructura del proyecto
WS/websoquet-server/
â”œâ”€â”€ cmd/
â”‚ â””â”€â”€ main.go # Punto de entrada
â”œâ”€â”€ internal/
â”‚ â”œâ”€â”€ adapter/
â”‚ â”‚ â”œâ”€â”€ client.go # Representa un cliente WebSocket
â”‚ â”‚ â””â”€â”€ handler.go # Controlador WebSocket
â”‚ â”œâ”€â”€ app/
â”‚ â”‚ â””â”€â”€ server.go # Configura el servidor
â”‚ â”œâ”€â”€ domain/
â”‚ â”‚ â””â”€â”€ message.go # Modelo del mensaje
â”‚ â””â”€â”€ service/
â”‚ â””â”€â”€ websoquet_service.go # Servicio para manejar conexiones


---

## ğŸš€ CÃ³mo iniciar el servidor

Ejecuta el servidor con:

```bash
go run ./cmd/main.go

ws://localhost:8080/ws?account=<Canal>

Ejemplo
ws://localhost:8080/ws?account=00:11:22:33:44:55

Formato De los Mensajes 
{
  "sender": "00:11:22:33:44:55",
  "receiver": "00:11:22:33:44:55",
  "content": {
    "macaddress": "31485",
    "mensaje": "ya jalo",
    "accion": "ya funciona",
    "nivel_peligro": "bajo",
    "fecha": "2025-02-02",
    "id_persona": 11
  }
}
âœ… Puedes enviar cualquier tipo de datos dentro del campo content. El servidor los procesarÃ¡ y reenviarÃ¡ tal cual a todos los clientes asociados al receiver.

ğŸ” Flujo de comunicaciÃ³n
API o Front se conecta mediante WebSocket a /ws?account=<mac>.

EnvÃ­a un JSON con sender, receiver y content.

El servidor reenvÃ­a ese mensaje solo a los clientes registrados bajo el receiver especificado.

Cualquier cliente con la misma direcciÃ³n MAC recibe el mensaje.

ğŸ‘¥ Soporte para mÃºltiples clientes
Cada direcciÃ³n MAC (accountID) puede tener varios clientes conectados simultÃ¡neamente. Por ejemplo:

Cliente A (frontend)

Cliente B (API backend)

Ambos conectados a: ?account=00:11:22:33:44:55.

Cualquier mensaje enviado por uno serÃ¡ recibido por los otros conectados con el mismo account.

ğŸ“‚ Detalle de cada archivo
main.go
Inicializa y arranca el servidor.

server.go
Registra la ruta /ws y lanza el Handler.

handler.go
Convierte conexiones HTTP a WebSocket, registra al cliente y reenvÃ­a mensajes entrantes.

client.go
Implementa lectura y escritura de mensajes WebSocket.

message.go
Modelo de datos flexible que acepta cualquier tipo de contenido en content.

websoquet_service.go
Soporta mÃºltiples clientes por cuenta/MAC.

ReenvÃ­a mensajes a todos los registrados bajo el mismo receiver.

Remueve clientes desconectados de forma segura.

ğŸ§ª Prueba con wscat
npm install -g wscat

wscat -c ws://localhost:8080/ws?account=123
Ejemplo de mensaje:

json
{"sender":"123","receiver":"123","content":{"mensaje":"Hola desde backend"}}

âœ… Ventajas del diseÃ±o
ComunicaciÃ³n en tiempo real 1:N (uno a varios).

MÃºltiples clientes por cuenta.

Independencia de contenido (content flexible).

SeparaciÃ³n clara entre capas (adaptador, dominio, servicio, etc.).



